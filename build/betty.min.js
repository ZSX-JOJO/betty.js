var Betty=function(t,e,n){function i(){}function o(t){if(!h.virtual)for(var e in h)0===e.indexOf(t)&&h.removeItem(e)}function r(t,n){var o,r,a="script";n=n||i,r=e.createElement(a),o=e.getElementsByTagName(a)[0],r.async=1,r.src=t,r.onload=function(){n()},r.onerror=function(){n(new Error("failed to load: "+t))},o.parentNode.insertBefore(r,o)}function a(t,e){function n(){return new Error("failed to load: "+t)}var i=new XMLHttpRequest;i.open("get",t),i.send(),i.addEventListener("error",n),i.addEventListener("load",function(t){var i=t.target;i.status>=400?n(i):e(i.response)})}function c(t,e){new Function("!"+t+"()")(),e&&setTimeout(e,0)}function s(){this.noCache=this.loadRemote=this.xDomain=!1,this.uri=this.key="",this.callbacks=[]}var u="BETTY",h=function(){var e=u,n=t.localStorage,o={setItem:i,getItem:i,removeItem:i,virtual:!0};if(!n)return o;try{return n.setItem(e,""),n.removeItem(e),n}catch(r){return o}}();return s.prototype={constructor:s,init:function(t){var e,i,r=t.config,a=t.callback,c=r.uri,s=r.key,f=r.noCache,l=r.xDomain;return this.uri=c,this.key=s,f!==n&&(this.noCache=f),l!==n&&(this.xDomain=l),e=u+":"+s+":"+c,i=h.getItem(e),this.storeKey=e,f||(this.code=i),i?a&&this.apply(a):(setTimeout(function(){o(s)},0),a&&this.callbacks.push(a)),this},add:function(t){var e=this.storeKey,n=t.toString();return this.code=n,this.noCache||h.setItem(e,n),c(n),this},apply:function(t){function e(){u.forEach(function(t){t()})}var n=this,i=this.code,o=this.uri,s=this.noCache,u=this.callbacks,h=this.loadRemote,f=this.xDomain;return i&&!s?c(i,t):(u.push(t),h||(f?r(o,e):a(o,function(t){n.add("function(){"+t+"}"),e()}),this.loadRemote=!0)),this},clear:function(t){return o(u+":"+t),this}},function(t,e){return(new s).init({config:t,callback:e})}}(window,document);